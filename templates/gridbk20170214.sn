<!DOCTYPE html>
{{     //  @version    1.01   add include for blog_detail

    use lg;         // Function publish use context lg
    use page;       // Function publish use context page for the content of the page
    use user;       // From sn_preload
    use grid;       // In sn_publish grid is initialize 

    %include "/extenso/functions/sn_ct.snc"; 
    %include "/extenso/functions/sn_widgets.snc"; 
	if page.rows{'page_' .+ lg.rows.lg} ne "index" then
		pageurl = page.rows{'folder_' .+ lg.rows.lg} .+ page.rows{'page_' .+ lg.rows.lg};
	else
		pageurl = page.rows{'folder_' .+ lg.rows.lg};
	endif // use by menus
}}
\{{ 
    config=config(); 
	page={	"uid":"{{page.rows.uid}}", 
			"role":"{{page.rows.role}}",
			"code":"{{page.rows.code}}",
			"url":"{{pageurl}}" 
			{{ for l sql("select * from sn_languages where active = 'yes'") do }}
				,"url_{{l.rows.lg}}":"{{page.rows{'folder_' .+ l.rows.lg};
				if page.rows{'page_' .+ l.rows.lg} ne "index" then
					page.rows{'page_' .+ l.rows.lg};
				endif
			}}"
			{{ endfor }}
	}; 
}}
<html lang="{{lg.rows.lg}}">
    <head>
        {{ %include "/includes/blog_detail.sn"; }}
              
        {{ %include "/includes/header.sn"; }}
        <!-- Generated by {{ 
                user.username; " " ; datetime();  " "; 
                files = filenames(); 
                for file in files.filenames do 
                    file; " ;  "; 
                    endfor 
        }} -->
    </head>
    <body class="site">
        
        \{{ 
            if config.site eq "staging" then 
                client_has_bootstrap = true; 
                if user.lg ne "" then
                    include("/extenso/html/extranet/" .+ user.lg .+ "/fullpage.snc");
                else
                    include("/extenso/html/extranet/fr/fullpage.snc"); 
                endif
            endif
        }}
        <div class="cs sed">
          	\{{ include("/" .+ config.site .+ "/includes/{{lg.rows.lg}}/header.snc"); }}
		 	<div class="sed-content">
                 <div class="widget_area_top">
					{{ sn_widgets(add:true,table:"pages",uid:page.rows.uid,lg:lg,position:"haut"); }}
                 </div>

                  <style scoped>
                  .sn_grid_main_menu {position:relative;right:0;top:0;z-index:502;margin:0!important;}
                  a.sn_grid_main_menu {
                      border: 1px solid transparent;
                      -moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;
                      display: inline-block;
                      font-size: 14px!important;
                      font-weight: 400;
                      line-height: 1.42857;
                      margin-bottom: 0;
                      padding: 6px 12px;
                      text-align: center;
                      vertical-align: middle;
                      white-space: nowrap;
                      background-color: #dddddd!important;
                      border-color: #dddddd!important;
                      color: #666666!important;
                  }

                  a.sn_grid_main_menu.widget-add {
                      padding: 1px;
                  }

                  a.sn_grid_main_menu.ct {
                      padding: 1px 4px 1px 4px!important; /* MODIFICATION DES MARGIN */
                      font-size: 8px!important; /* MODIFICITION FONT-SIZE */
                      color: black!important;
                  }
                  .sn_grid_main_menu .link {
                      border: 1px solid transparent;
                      -moz-border-radius:4px;-webkit-border-radius:4px;border-radius:4px;
                      display: inline-block;
                      font-size: 14px!important;
                      font-weight: 400;
                      line-height: 1.42857;
                      margin-bottom: 0;
                      padding: 6px 12px;
                      text-align: center;
                      vertical-align: middle;
                      white-space: nowrap;
                      background-color: #dddddd!important;
                      border-color: #dddddd!important;
                      color: #666666!important;
                  }
                  </style>
            
            <div class="cs-main-content">
				<!--<div class='sn_grid_main_menu'><a class='link'><i class='fa fa-bars'></i></a></div>-->
				{{ // --------------- Implement Grid
					uid_grid = grid.rows.uid;
					grid = unstringnify(grid.rows.grid);
					uid_grid = uid_grid + 0;
					page_id = page.rows.uid + 0;  
					row_number = 0;
					col_number = 0;
				
					allgrids = {};
					
					for row in grid.grid do 
						fluid=grid.parms.fullpage[row_number];
						classdef=grid.parms.classdef[row_number];
						row_number++;
				}}
					<div class="{{classdef}} container{{ if fluid eq "yes" then "-fluid"; endif }}" style="min-height:50px;">
                        <div class="row">
                            {{ for col in row do 
                                col_number++;
                                content = sql(single:true,"select * from sn_template_grid_content where uid_page='?' and row='?' and col='?'", page_id, row_number, col_number); 
                                if content.nbrows == 0 then
                                    void insert(table:"sn_template_grid_content",user:user,fields:{"uid_page":page_id,"row":row_number,"col":col_number,"uid_grid":uid_grid});
                                    content = sql(single:true,"select * from sn_template_grid_content where uid_page='?' and row='?' and col='?'", page_id, row_number, col_number); 
                                else
                                    tmp_uid_grid = content.rows.uid_grid + 0;
                                    if tmp_uid_grid == 0 then
                                        void sql("UPDATE sn_template_grid_content SET uid_grid='?' WHERE uid_page='?' AND row='?' AND col='?'", uid_grid, page_id, row_number, col_number); 
                                    endif
                                endif
                            }}
                                <div class="sn_pencil sn-grid col-md-{{col}}" 
                                    data-sn_link1="/extenso/extranet/sn_template_grid_content/{{lg.rows.lg}}/edit.snc?uid={{content.rows.uid}}&sn_uniq=yes&sn_modal=t" 
                                    data-sn_class1="edit" data-sn_title1="Edit">{{ 
                                    }}
                                    {{ title = content.rows{"titre_" .+ lg.rows.lg}; }}
                                    {{ if title ne "" then }}
                                        <h2>{{ title }}</h2>
                                    {{ endif }}
                                    {{
                                        content.rows{"texte_" .+ lg.rows.lg}; 
                                        allgrids{"grid-" .+ row_number .+ col_number} = 1;
                                        sn_widgets(add:true,table:"pages",uid:page.rows.uid,lg:lg,position:"grid-" .+ row_number .+ col_number); 

                                    }}
                                </div>
                            {{  endfor }}
                        </div><!--/.row-->
                    </div><!--/.container-->
				{{  endfor }}
	
			</div>
	
			\{{ include("/" .+ config.site .+ "/includes/{{lg.rows.lg}}/footer.snc"); }}
           </div>
        </div><!--/.cs-->
         
        {{ // ---- FOOTER FOR THE GOOGLE ANALYTICS ----- }}
		{{ %include "/includes/footer.sn"; }}
     
    </body>
</html>